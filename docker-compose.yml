
services:
  edge-go:
    build:
      context: .
      dockerfile: Dockerfile.edge
    environment:
      - ORYX_SERVER=${ORYX_SERVER}
      - ORYX_SERVER2=${ORYX_SERVER2}
      - ORYX_SKIP_TLS_VERIFY=${ORYX_SKIP_TLS_VERIFY:-false}
      - PERYA_SERVER=${PERYA_SERVER}
      - PERYA_SKIP_TLS_VERIFY=${PERYA_SKIP_TLS_VERIFY:-false}
      - PRIME_STREAM_HOST=${PRIME_STREAM_HOST}
      - PRIME_STREAM_ORIGIN=${PRIME_STREAM_ORIGIN}
      - PRIME_STREAM_REFERER=${PRIME_STREAM_REFERER}
      - DISABLE_TLS_VERIFY=${DISABLE_TLS_VERIFY:-false}
      - UPSTREAM_TIMEOUT=${UPSTREAM_TIMEOUT:-5s}
      - CACHE_SIZE=${CACHE_SIZE:-512}
      - CACHE_TTL_PLAYLIST=${CACHE_TTL_PLAYLIST:-2s}
      - CACHE_TTL_SEGMENT=${CACHE_TTL_SEGMENT:-30s}
      - PREFETCH_WORKERS=${PREFETCH_WORKERS:-4}
      - PREFETCH_BATCH=${PREFETCH_BATCH:-5}
      - ENABLE_PREFETCH=${ENABLE_PREFETCH:-true}
      - SV_ORIGIN=${SV_ORIGIN}
      - SV_HOST_HEADER=${SV_HOST_HEADER}
      - SV_ORIGIN10=${SV_ORIGIN10}
      - SV_HOST_HEADER10=${SV_HOST_HEADER10}
      - SV_ORIGIN9=${SV_ORIGIN9}
      - SV_HOST_HEADER9=${SV_HOST_HEADER9}
      - SV_ORIGIN8=${SV_ORIGIN8}
      - SV_HOST_HEADER8=${SV_HOST_HEADER8}
      - SV_ORIGIN7=${SV_ORIGIN7}
      - SV_HOST_HEADER7=${SV_HOST_HEADER7}
      - UK_ORIGIN=${UK_ORIGIN}
      - UK_HOST_HEADER=${UK_HOST_HEADER}
      - UK_REFERER=${UK_REFERER}
      - UK_SKIP_TLS_VERIFY=${UK_SKIP_TLS_VERIFY:-false}
    expose:
      - "9000"
    restart: unless-stopped

  edge-proxy:
    build: .
    container_name: nginx-live
    depends_on:
      - edge-go
    ports:
      - "8080:80"
    restart: unless-stopped
